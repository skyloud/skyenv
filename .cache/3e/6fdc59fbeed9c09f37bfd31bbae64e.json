{"id":"nrlO","dependencies":[{"name":"/Users/etienne/skyenv/package.json","includedInParent":true,"mtime":1596478551490},{"name":"/Users/etienne/skyenv/node_modules/mongodb/package.json","includedInParent":true,"mtime":1596467161400},{"name":"./auth_provider","loc":{"line":2,"column":29},"parent":"/Users/etienne/skyenv/node_modules/mongodb/lib/core/auth/x509.js","resolved":"/Users/etienne/skyenv/node_modules/mongodb/lib/core/auth/auth_provider.js"}],"generated":{"js":"\"use strict\";const e=require(\"./auth_provider\").AuthProvider;class t extends e{prepare(e,t,s){const c=t.credentials;Object.assign(e,{speculativeAuthenticate:n(c)}),s(void 0,e)}auth(e,t){const s=e.connection,c=e.credentials;if(e.response.speculativeAuthenticate)return t();s.command(\"$external.$cmd\",n(c),t)}}function n(e){const t={authenticate:1,mechanism:\"MONGODB-X509\"};return e.username&&Object.apply(t,{user:e.username}),t}module.exports=t;"},"sourceMaps":{"js":{"mappings":[{"source":"../node_modules/mongodb/lib/core/auth/x509.js","original":{"line":1,"column":0},"generated":{"line":1,"column":0}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","original":{"line":2,"column":0},"generated":{"line":1,"column":13}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"AuthProvider","original":{"line":2,"column":6},"generated":{"line":1,"column":19}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"require","original":{"line":2,"column":21},"generated":{"line":1,"column":21}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","original":{"line":2,"column":29},"generated":{"line":1,"column":29}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"AuthProvider","original":{"line":2,"column":48},"generated":{"line":1,"column":48}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","original":{"line":4,"column":0},"generated":{"line":1,"column":61}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"X509","original":{"line":4,"column":6},"generated":{"line":1,"column":67}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"AuthProvider","original":{"line":4,"column":19},"generated":{"line":1,"column":77}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"prepare","original":{"line":5,"column":2},"generated":{"line":1,"column":79}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"handshakeDoc","original":{"line":5,"column":10},"generated":{"line":1,"column":87}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"authContext","original":{"line":5,"column":24},"generated":{"line":1,"column":89}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"callback","original":{"line":5,"column":37},"generated":{"line":1,"column":91}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"credentials","original":{"line":6,"column":10},"generated":{"line":1,"column":94}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"credentials","original":{"line":6,"column":10},"generated":{"line":1,"column":100}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"authContext","original":{"line":6,"column":24},"generated":{"line":1,"column":102}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"credentials","original":{"line":6,"column":36},"generated":{"line":1,"column":104}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"Object","original":{"line":7,"column":4},"generated":{"line":1,"column":116}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"assign","original":{"line":7,"column":11},"generated":{"line":1,"column":123}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"handshakeDoc","original":{"line":7,"column":18},"generated":{"line":1,"column":130}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","original":{"line":7,"column":32},"generated":{"line":1,"column":132}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"speculativeAuthenticate","original":{"line":8,"column":6},"generated":{"line":1,"column":133}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"x509AuthenticateCommand","original":{"line":8,"column":31},"generated":{"line":1,"column":157}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"credentials","original":{"line":8,"column":55},"generated":{"line":1,"column":159}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"callback","original":{"line":11,"column":4},"generated":{"line":1,"column":164}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"undefined","original":{"line":11,"column":13},"generated":{"line":1,"column":171}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"handshakeDoc","original":{"line":11,"column":24},"generated":{"line":1,"column":173}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"auth","original":{"line":14,"column":2},"generated":{"line":1,"column":176}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"authContext","original":{"line":14,"column":7},"generated":{"line":1,"column":181}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"callback","original":{"line":14,"column":20},"generated":{"line":1,"column":183}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"connection","original":{"line":15,"column":10},"generated":{"line":1,"column":186}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"connection","original":{"line":15,"column":10},"generated":{"line":1,"column":192}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"authContext","original":{"line":15,"column":23},"generated":{"line":1,"column":194}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"connection","original":{"line":15,"column":35},"generated":{"line":1,"column":196}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"credentials","original":{"line":16,"column":10},"generated":{"line":1,"column":207}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"authContext","original":{"line":16,"column":24},"generated":{"line":1,"column":209}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"credentials","original":{"line":16,"column":36},"generated":{"line":1,"column":211}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"response","original":{"line":18,"column":8},"generated":{"line":1,"column":223}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"authContext","original":{"line":17,"column":21},"generated":{"line":1,"column":226}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"response","original":{"line":17,"column":33},"generated":{"line":1,"column":228}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"speculativeAuthenticate","original":{"line":18,"column":17},"generated":{"line":1,"column":237}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"callback","original":{"line":19,"column":13},"generated":{"line":1,"column":261}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"callback","original":{"line":19,"column":13},"generated":{"line":1,"column":268}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"connection","original":{"line":22,"column":4},"generated":{"line":1,"column":272}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"command","original":{"line":22,"column":15},"generated":{"line":1,"column":274}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","original":{"line":22,"column":23},"generated":{"line":1,"column":282}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"x509AuthenticateCommand","original":{"line":22,"column":41},"generated":{"line":1,"column":299}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"credentials","original":{"line":22,"column":65},"generated":{"line":1,"column":301}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"callback","original":{"line":22,"column":79},"generated":{"line":1,"column":304}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","original":{"line":26,"column":0},"generated":{"line":1,"column":308}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"x509AuthenticateCommand","original":{"line":26,"column":9},"generated":{"line":1,"column":317}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"credentials","original":{"line":26,"column":33},"generated":{"line":1,"column":319}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"command","original":{"line":27,"column":8},"generated":{"line":1,"column":322}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"command","original":{"line":27,"column":8},"generated":{"line":1,"column":328}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","original":{"line":27,"column":18},"generated":{"line":1,"column":330}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"authenticate","original":{"line":27,"column":20},"generated":{"line":1,"column":331}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","original":{"line":27,"column":34},"generated":{"line":1,"column":344}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"mechanism","original":{"line":27,"column":37},"generated":{"line":1,"column":346}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","original":{"line":27,"column":48},"generated":{"line":1,"column":356}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"command","original":{"line":32,"column":9},"generated":{"line":1,"column":372}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"credentials","original":{"line":28,"column":6},"generated":{"line":1,"column":379}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"username","original":{"line":28,"column":18},"generated":{"line":1,"column":381}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"Object","original":{"line":29,"column":4},"generated":{"line":1,"column":391}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"apply","original":{"line":29,"column":11},"generated":{"line":1,"column":398}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"command","original":{"line":29,"column":17},"generated":{"line":1,"column":404}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","original":{"line":29,"column":26},"generated":{"line":1,"column":406}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"user","original":{"line":29,"column":28},"generated":{"line":1,"column":407}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"credentials","original":{"line":29,"column":34},"generated":{"line":1,"column":412}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"username","original":{"line":29,"column":46},"generated":{"line":1,"column":414}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"command","original":{"line":32,"column":9},"generated":{"line":1,"column":425}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"module","original":{"line":35,"column":0},"generated":{"line":1,"column":427}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"exports","original":{"line":35,"column":7},"generated":{"line":1,"column":434}},{"source":"../node_modules/mongodb/lib/core/auth/x509.js","name":"X509","original":{"line":35,"column":17},"generated":{"line":1,"column":442}}],"sources":{"../node_modules/mongodb/lib/core/auth/x509.js":"'use strict';\nconst AuthProvider = require('./auth_provider').AuthProvider;\n\nclass X509 extends AuthProvider {\n  prepare(handshakeDoc, authContext, callback) {\n    const credentials = authContext.credentials;\n    Object.assign(handshakeDoc, {\n      speculativeAuthenticate: x509AuthenticateCommand(credentials)\n    });\n\n    callback(undefined, handshakeDoc);\n  }\n\n  auth(authContext, callback) {\n    const connection = authContext.connection;\n    const credentials = authContext.credentials;\n    const response = authContext.response;\n    if (response.speculativeAuthenticate) {\n      return callback();\n    }\n\n    connection.command('$external.$cmd', x509AuthenticateCommand(credentials), callback);\n  }\n}\n\nfunction x509AuthenticateCommand(credentials) {\n  const command = { authenticate: 1, mechanism: 'MONGODB-X509' };\n  if (credentials.username) {\n    Object.apply(command, { user: credentials.username });\n  }\n\n  return command;\n}\n\nmodule.exports = X509;\n"},"lineCount":null}},"error":null,"hash":"2aad9ef70e20af335b95f398c16af369","cacheData":{"env":{}}}