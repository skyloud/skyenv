{"id":"gvo2","dependencies":[{"name":"/Users/etienne/skyenv/package.json","includedInParent":true,"mtime":1596478551490},{"name":"/Users/etienne/skyenv/node_modules/mongodb/package.json","includedInParent":true,"mtime":1596467161400},{"name":"./common","loc":{"line":3,"column":23},"parent":"/Users/etienne/skyenv/node_modules/mongodb/lib/bulk/unordered.js","resolved":"/Users/etienne/skyenv/node_modules/mongodb/lib/bulk/common.js"},{"name":"../utils","loc":{"line":7,"column":22},"parent":"/Users/etienne/skyenv/node_modules/mongodb/lib/bulk/unordered.js","resolved":"/Users/etienne/skyenv/node_modules/mongodb/lib/utils.js"}],"generated":{"js":"\"use strict\";const e=require(\"./common\"),r=e.BulkOperationBase,t=e.Batch,s=e.bson,n=require(\"../utils\"),c=n.toError;function a(r,n,a){const u=s.calculateObjectSize(a,{checkKeys:!1,ignoreUndefined:!1});if(u>=r.s.maxBsonObjectSize)throw c(\"document is larger than the maximum size \"+r.s.maxBsonObjectSize);r.s.currentBatch=null,n===e.INSERT?r.s.currentBatch=r.s.currentInsertBatch:n===e.UPDATE?r.s.currentBatch=r.s.currentUpdateBatch:n===e.REMOVE&&(r.s.currentBatch=r.s.currentRemoveBatch);const h=r.s.maxKeySize;if(null==r.s.currentBatch&&(r.s.currentBatch=new t(n,r.s.currentIndex)),(r.s.currentBatch.size+1>=r.s.maxWriteBatchSize||r.s.currentBatch.size>0&&r.s.currentBatch.sizeBytes+h+u>=r.s.maxBatchSizeBytes||r.s.currentBatch.batchType!==n)&&(r.s.batches.push(r.s.currentBatch),r.s.currentBatch=new t(n,r.s.currentIndex)),Array.isArray(a))throw c(\"operation passed in cannot be an Array\");return r.s.currentBatch.operations.push(a),r.s.currentBatch.originalIndexes.push(r.s.currentIndex),r.s.currentIndex=r.s.currentIndex+1,n===e.INSERT?(r.s.currentInsertBatch=r.s.currentBatch,r.s.bulkResult.insertedIds.push({index:r.s.bulkResult.insertedIds.length,_id:a._id})):n===e.UPDATE?r.s.currentUpdateBatch=r.s.currentBatch:n===e.REMOVE&&(r.s.currentRemoveBatch=r.s.currentBatch),r.s.currentBatch.size+=1,r.s.currentBatch.sizeBytes+=h+u,r}class u extends r{constructor(e,r,t){t=t||{},super(e,r,t=Object.assign(t,{addToOperationsList:a}),!1)}handleWriteError(e,r){return!this.s.batches.length&&super.handleWriteError(e,r)}}function h(e,r,t){return new u(e,r,t)}h.UnorderedBulkOperation=u,module.exports=h,module.exports.Bulk=u;"},"sourceMaps":{"js":{"mappings":[{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":1,"column":0},"generated":{"line":1,"column":0}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":3,"column":0},"generated":{"line":1,"column":13}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"common","original":{"line":3,"column":6},"generated":{"line":1,"column":19}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"require","original":{"line":3,"column":15},"generated":{"line":1,"column":21}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":3,"column":23},"generated":{"line":1,"column":29}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"BulkOperationBase","original":{"line":4,"column":6},"generated":{"line":1,"column":41}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"common","original":{"line":4,"column":26},"generated":{"line":1,"column":43}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"BulkOperationBase","original":{"line":4,"column":33},"generated":{"line":1,"column":45}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"Batch","original":{"line":5,"column":6},"generated":{"line":1,"column":63}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"common","original":{"line":5,"column":14},"generated":{"line":1,"column":65}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"Batch","original":{"line":5,"column":21},"generated":{"line":1,"column":67}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bson","original":{"line":6,"column":6},"generated":{"line":1,"column":73}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"common","original":{"line":6,"column":13},"generated":{"line":1,"column":75}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bson","original":{"line":6,"column":20},"generated":{"line":1,"column":77}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"utils","original":{"line":7,"column":6},"generated":{"line":1,"column":82}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"require","original":{"line":7,"column":14},"generated":{"line":1,"column":84}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":7,"column":22},"generated":{"line":1,"column":92}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"toError","original":{"line":8,"column":6},"generated":{"line":1,"column":104}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"utils","original":{"line":8,"column":16},"generated":{"line":1,"column":106}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"toError","original":{"line":8,"column":22},"generated":{"line":1,"column":108}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":19,"column":0},"generated":{"line":1,"column":116}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"addToOperationsList","original":{"line":19,"column":9},"generated":{"line":1,"column":125}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":19,"column":29},"generated":{"line":1,"column":127}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"docType","original":{"line":19,"column":44},"generated":{"line":1,"column":129}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"document","original":{"line":19,"column":53},"generated":{"line":1,"column":131}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bsonSize","original":{"line":21,"column":8},"generated":{"line":1,"column":134}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bsonSize","original":{"line":21,"column":8},"generated":{"line":1,"column":140}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bson","original":{"line":21,"column":19},"generated":{"line":1,"column":142}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"calculateObjectSize","original":{"line":21,"column":24},"generated":{"line":1,"column":144}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"document","original":{"line":21,"column":44},"generated":{"line":1,"column":164}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":21,"column":54},"generated":{"line":1,"column":166}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"checkKeys","original":{"line":22,"column":4},"generated":{"line":1,"column":167}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":22,"column":15},"generated":{"line":1,"column":178}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"ignoreUndefined","original":{"line":26,"column":4},"generated":{"line":1,"column":180}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":26,"column":21},"generated":{"line":1,"column":197}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bsonSize","original":{"line":29,"column":6},"generated":{"line":1,"column":201}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bsonSize","original":{"line":29,"column":6},"generated":{"line":1,"column":204}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":29,"column":18},"generated":{"line":1,"column":207}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":29,"column":32},"generated":{"line":1,"column":209}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"maxBsonObjectSize","original":{"line":29,"column":34},"generated":{"line":1,"column":211}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":30,"column":4},"generated":{"line":1,"column":229}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"toError","original":{"line":30,"column":10},"generated":{"line":1,"column":235}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":30,"column":18},"generated":{"line":1,"column":237}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":30,"column":64},"generated":{"line":1,"column":281}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":30,"column":78},"generated":{"line":1,"column":283}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"maxBsonObjectSize","original":{"line":30,"column":80},"generated":{"line":1,"column":285}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":32,"column":2},"generated":{"line":1,"column":304}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":32,"column":16},"generated":{"line":1,"column":306}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentBatch","original":{"line":32,"column":18},"generated":{"line":1,"column":308}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":32,"column":33},"generated":{"line":1,"column":321}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"docType","original":{"line":34,"column":6},"generated":{"line":1,"column":326}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"common","original":{"line":34,"column":18},"generated":{"line":1,"column":330}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"INSERT","original":{"line":34,"column":25},"generated":{"line":1,"column":332}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":35,"column":4},"generated":{"line":1,"column":339}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":35,"column":18},"generated":{"line":1,"column":341}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentBatch","original":{"line":35,"column":20},"generated":{"line":1,"column":343}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":35,"column":35},"generated":{"line":1,"column":356}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":35,"column":49},"generated":{"line":1,"column":358}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentInsertBatch","original":{"line":35,"column":51},"generated":{"line":1,"column":360}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"docType","original":{"line":36,"column":13},"generated":{"line":1,"column":379}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"common","original":{"line":36,"column":25},"generated":{"line":1,"column":383}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"UPDATE","original":{"line":36,"column":32},"generated":{"line":1,"column":385}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":37,"column":4},"generated":{"line":1,"column":392}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":37,"column":18},"generated":{"line":1,"column":394}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentBatch","original":{"line":37,"column":20},"generated":{"line":1,"column":396}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":37,"column":35},"generated":{"line":1,"column":409}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":37,"column":49},"generated":{"line":1,"column":411}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentUpdateBatch","original":{"line":37,"column":51},"generated":{"line":1,"column":413}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"docType","original":{"line":38,"column":13},"generated":{"line":1,"column":432}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"common","original":{"line":38,"column":25},"generated":{"line":1,"column":436}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"REMOVE","original":{"line":38,"column":32},"generated":{"line":1,"column":438}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":39,"column":4},"generated":{"line":1,"column":447}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":39,"column":18},"generated":{"line":1,"column":449}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentBatch","original":{"line":39,"column":20},"generated":{"line":1,"column":451}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":39,"column":35},"generated":{"line":1,"column":464}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":39,"column":49},"generated":{"line":1,"column":466}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentRemoveBatch","original":{"line":39,"column":51},"generated":{"line":1,"column":468}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"maxKeySize","original":{"line":42,"column":8},"generated":{"line":1,"column":488}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"maxKeySize","original":{"line":42,"column":8},"generated":{"line":1,"column":494}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":42,"column":21},"generated":{"line":1,"column":496}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":42,"column":35},"generated":{"line":1,"column":498}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"maxKeySize","original":{"line":42,"column":37},"generated":{"line":1,"column":500}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"Array","original":{"line":68,"column":6},"generated":{"line":1,"column":511}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":45,"column":38},"generated":{"line":1,"column":514}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":45,"column":6},"generated":{"line":1,"column":520}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":45,"column":20},"generated":{"line":1,"column":522}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentBatch","original":{"line":45,"column":22},"generated":{"line":1,"column":524}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":46,"column":4},"generated":{"line":1,"column":539}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":46,"column":18},"generated":{"line":1,"column":541}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentBatch","original":{"line":46,"column":20},"generated":{"line":1,"column":543}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":46,"column":35},"generated":{"line":1,"column":556}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"Batch","original":{"line":46,"column":39},"generated":{"line":1,"column":560}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"docType","original":{"line":46,"column":45},"generated":{"line":1,"column":562}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":46,"column":54},"generated":{"line":1,"column":564}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":46,"column":68},"generated":{"line":1,"column":566}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentIndex","original":{"line":46,"column":70},"generated":{"line":1,"column":568}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":51,"column":4},"generated":{"line":1,"column":584}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":51,"column":18},"generated":{"line":1,"column":586}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentBatch","original":{"line":51,"column":20},"generated":{"line":1,"column":588}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"size","original":{"line":51,"column":33},"generated":{"line":1,"column":601}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":51,"column":40},"generated":{"line":1,"column":606}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":51,"column":45},"generated":{"line":1,"column":609}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":51,"column":59},"generated":{"line":1,"column":611}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"maxWriteBatchSize","original":{"line":51,"column":61},"generated":{"line":1,"column":613}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":54,"column":5},"generated":{"line":1,"column":632}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":54,"column":19},"generated":{"line":1,"column":634}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentBatch","original":{"line":54,"column":21},"generated":{"line":1,"column":636}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"size","original":{"line":54,"column":34},"generated":{"line":1,"column":649}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":54,"column":41},"generated":{"line":1,"column":654}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":55,"column":6},"generated":{"line":1,"column":657}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":55,"column":20},"generated":{"line":1,"column":659}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentBatch","original":{"line":55,"column":22},"generated":{"line":1,"column":661}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"sizeBytes","original":{"line":55,"column":35},"generated":{"line":1,"column":674}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"maxKeySize","original":{"line":55,"column":47},"generated":{"line":1,"column":684}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bsonSize","original":{"line":55,"column":60},"generated":{"line":1,"column":686}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":56,"column":8},"generated":{"line":1,"column":689}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":56,"column":22},"generated":{"line":1,"column":691}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"maxBatchSizeBytes","original":{"line":56,"column":24},"generated":{"line":1,"column":693}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":58,"column":4},"generated":{"line":1,"column":712}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":58,"column":18},"generated":{"line":1,"column":714}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentBatch","original":{"line":58,"column":20},"generated":{"line":1,"column":716}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"batchType","original":{"line":58,"column":33},"generated":{"line":1,"column":729}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"docType","original":{"line":58,"column":47},"generated":{"line":1,"column":741}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":61,"column":4},"generated":{"line":1,"column":746}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":61,"column":18},"generated":{"line":1,"column":748}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"batches","original":{"line":61,"column":20},"generated":{"line":1,"column":750}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"push","original":{"line":61,"column":28},"generated":{"line":1,"column":758}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":61,"column":33},"generated":{"line":1,"column":763}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":61,"column":47},"generated":{"line":1,"column":765}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentBatch","original":{"line":61,"column":49},"generated":{"line":1,"column":767}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":64,"column":4},"generated":{"line":1,"column":781}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":64,"column":18},"generated":{"line":1,"column":783}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentBatch","original":{"line":64,"column":20},"generated":{"line":1,"column":785}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":64,"column":35},"generated":{"line":1,"column":798}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"Batch","original":{"line":64,"column":39},"generated":{"line":1,"column":802}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"docType","original":{"line":64,"column":45},"generated":{"line":1,"column":804}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":64,"column":54},"generated":{"line":1,"column":806}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":64,"column":68},"generated":{"line":1,"column":808}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentIndex","original":{"line":64,"column":70},"generated":{"line":1,"column":810}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"Array","original":{"line":68,"column":6},"generated":{"line":1,"column":825}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"isArray","original":{"line":68,"column":12},"generated":{"line":1,"column":831}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"document","original":{"line":68,"column":20},"generated":{"line":1,"column":839}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"toError","original":{"line":69,"column":10},"generated":{"line":1,"column":842}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"toError","original":{"line":69,"column":10},"generated":{"line":1,"column":848}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":69,"column":18},"generated":{"line":1,"column":850}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":94,"column":9},"generated":{"line":1,"column":892}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":72,"column":2},"generated":{"line":1,"column":899}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":72,"column":16},"generated":{"line":1,"column":901}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentBatch","original":{"line":72,"column":18},"generated":{"line":1,"column":903}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"operations","original":{"line":72,"column":31},"generated":{"line":1,"column":916}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"push","original":{"line":72,"column":42},"generated":{"line":1,"column":927}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"document","original":{"line":72,"column":47},"generated":{"line":1,"column":932}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":73,"column":2},"generated":{"line":1,"column":935}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":73,"column":16},"generated":{"line":1,"column":937}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentBatch","original":{"line":73,"column":18},"generated":{"line":1,"column":939}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"originalIndexes","original":{"line":73,"column":31},"generated":{"line":1,"column":952}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"push","original":{"line":73,"column":47},"generated":{"line":1,"column":968}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":73,"column":52},"generated":{"line":1,"column":973}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":73,"column":66},"generated":{"line":1,"column":975}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentIndex","original":{"line":73,"column":68},"generated":{"line":1,"column":977}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":74,"column":2},"generated":{"line":1,"column":991}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":74,"column":16},"generated":{"line":1,"column":993}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentIndex","original":{"line":74,"column":18},"generated":{"line":1,"column":995}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":74,"column":33},"generated":{"line":1,"column":1008}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":74,"column":47},"generated":{"line":1,"column":1010}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentIndex","original":{"line":74,"column":49},"generated":{"line":1,"column":1012}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":74,"column":64},"generated":{"line":1,"column":1025}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"docType","original":{"line":77,"column":6},"generated":{"line":1,"column":1027}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"common","original":{"line":77,"column":18},"generated":{"line":1,"column":1031}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"INSERT","original":{"line":77,"column":25},"generated":{"line":1,"column":1033}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":78,"column":4},"generated":{"line":1,"column":1041}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":78,"column":18},"generated":{"line":1,"column":1043}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentInsertBatch","original":{"line":78,"column":20},"generated":{"line":1,"column":1045}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":78,"column":41},"generated":{"line":1,"column":1064}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":78,"column":55},"generated":{"line":1,"column":1066}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentBatch","original":{"line":78,"column":57},"generated":{"line":1,"column":1068}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":79,"column":4},"generated":{"line":1,"column":1081}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":79,"column":18},"generated":{"line":1,"column":1083}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkResult","original":{"line":79,"column":20},"generated":{"line":1,"column":1085}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"insertedIds","original":{"line":79,"column":31},"generated":{"line":1,"column":1096}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"push","original":{"line":79,"column":43},"generated":{"line":1,"column":1108}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":79,"column":48},"generated":{"line":1,"column":1113}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"index","original":{"line":80,"column":6},"generated":{"line":1,"column":1114}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":80,"column":13},"generated":{"line":1,"column":1120}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":80,"column":27},"generated":{"line":1,"column":1122}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkResult","original":{"line":80,"column":29},"generated":{"line":1,"column":1124}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"insertedIds","original":{"line":80,"column":40},"generated":{"line":1,"column":1135}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"length","original":{"line":80,"column":52},"generated":{"line":1,"column":1147}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"_id","original":{"line":81,"column":6},"generated":{"line":1,"column":1154}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"document","original":{"line":81,"column":11},"generated":{"line":1,"column":1158}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"_id","original":{"line":81,"column":20},"generated":{"line":1,"column":1160}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"docType","original":{"line":83,"column":13},"generated":{"line":1,"column":1167}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"common","original":{"line":83,"column":25},"generated":{"line":1,"column":1171}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"UPDATE","original":{"line":83,"column":32},"generated":{"line":1,"column":1173}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":84,"column":4},"generated":{"line":1,"column":1180}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":84,"column":18},"generated":{"line":1,"column":1182}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentUpdateBatch","original":{"line":84,"column":20},"generated":{"line":1,"column":1184}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":84,"column":41},"generated":{"line":1,"column":1203}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":84,"column":55},"generated":{"line":1,"column":1205}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentBatch","original":{"line":84,"column":57},"generated":{"line":1,"column":1207}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"docType","original":{"line":85,"column":13},"generated":{"line":1,"column":1220}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"common","original":{"line":85,"column":25},"generated":{"line":1,"column":1224}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"REMOVE","original":{"line":85,"column":32},"generated":{"line":1,"column":1226}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":86,"column":4},"generated":{"line":1,"column":1235}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":86,"column":18},"generated":{"line":1,"column":1237}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentRemoveBatch","original":{"line":86,"column":20},"generated":{"line":1,"column":1239}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":86,"column":41},"generated":{"line":1,"column":1258}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":86,"column":55},"generated":{"line":1,"column":1260}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentBatch","original":{"line":86,"column":57},"generated":{"line":1,"column":1262}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":90,"column":2},"generated":{"line":1,"column":1276}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":90,"column":16},"generated":{"line":1,"column":1278}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentBatch","original":{"line":90,"column":18},"generated":{"line":1,"column":1280}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"size","original":{"line":90,"column":31},"generated":{"line":1,"column":1293}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":90,"column":39},"generated":{"line":1,"column":1299}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":91,"column":2},"generated":{"line":1,"column":1301}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":91,"column":16},"generated":{"line":1,"column":1303}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"currentBatch","original":{"line":91,"column":18},"generated":{"line":1,"column":1305}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"sizeBytes","original":{"line":91,"column":31},"generated":{"line":1,"column":1318}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"maxKeySize","original":{"line":91,"column":44},"generated":{"line":1,"column":1329}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bsonSize","original":{"line":91,"column":57},"generated":{"line":1,"column":1331}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"bulkOperation","original":{"line":94,"column":9},"generated":{"line":1,"column":1333}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":104,"column":0},"generated":{"line":1,"column":1335}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"UnorderedBulkOperation","original":{"line":104,"column":6},"generated":{"line":1,"column":1341}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"BulkOperationBase","original":{"line":104,"column":37},"generated":{"line":1,"column":1351}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"constructor","original":{"line":105,"column":2},"generated":{"line":1,"column":1353}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"topology","original":{"line":105,"column":14},"generated":{"line":1,"column":1365}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"collection","original":{"line":105,"column":24},"generated":{"line":1,"column":1367}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"options","original":{"line":105,"column":36},"generated":{"line":1,"column":1369}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"options","original":{"line":106,"column":4},"generated":{"line":1,"column":1372}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"options","original":{"line":106,"column":14},"generated":{"line":1,"column":1374}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":106,"column":25},"generated":{"line":1,"column":1377}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"topology","original":{"line":109,"column":10},"generated":{"line":1,"column":1380}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"topology","original":{"line":109,"column":10},"generated":{"line":1,"column":1386}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"collection","original":{"line":109,"column":20},"generated":{"line":1,"column":1388}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"options","original":{"line":107,"column":4},"generated":{"line":1,"column":1390}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"Object","original":{"line":107,"column":14},"generated":{"line":1,"column":1392}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"assign","original":{"line":107,"column":21},"generated":{"line":1,"column":1399}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"options","original":{"line":107,"column":28},"generated":{"line":1,"column":1406}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":107,"column":37},"generated":{"line":1,"column":1408}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"addToOperationsList","original":{"line":107,"column":39},"generated":{"line":1,"column":1409}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"addToOperationsList","original":{"line":107,"column":39},"generated":{"line":1,"column":1429}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":109,"column":41},"generated":{"line":1,"column":1434}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"handleWriteError","original":{"line":112,"column":2},"generated":{"line":1,"column":1437}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"callback","original":{"line":112,"column":19},"generated":{"line":1,"column":1454}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"writeResult","original":{"line":112,"column":29},"generated":{"line":1,"column":1456}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":113,"column":8},"generated":{"line":1,"column":1459}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":113,"column":8},"generated":{"line":1,"column":1466}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"s","original":{"line":113,"column":13},"generated":{"line":1,"column":1471}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"batches","original":{"line":113,"column":15},"generated":{"line":1,"column":1473}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"length","original":{"line":113,"column":23},"generated":{"line":1,"column":1481}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":117,"column":11},"generated":{"line":1,"column":1489}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"handleWriteError","original":{"line":117,"column":17},"generated":{"line":1,"column":1495}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"callback","original":{"line":117,"column":34},"generated":{"line":1,"column":1512}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"writeResult","original":{"line":117,"column":44},"generated":{"line":1,"column":1514}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":125,"column":0},"generated":{"line":1,"column":1518}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"initializeUnorderedBulkOp","original":{"line":125,"column":9},"generated":{"line":1,"column":1527}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"topology","original":{"line":125,"column":35},"generated":{"line":1,"column":1529}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"collection","original":{"line":125,"column":45},"generated":{"line":1,"column":1531}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"options","original":{"line":125,"column":57},"generated":{"line":1,"column":1533}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":126,"column":9},"generated":{"line":1,"column":1536}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","original":{"line":126,"column":9},"generated":{"line":1,"column":1543}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"UnorderedBulkOperation","original":{"line":126,"column":13},"generated":{"line":1,"column":1547}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"topology","original":{"line":126,"column":36},"generated":{"line":1,"column":1549}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"collection","original":{"line":126,"column":46},"generated":{"line":1,"column":1551}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"options","original":{"line":126,"column":58},"generated":{"line":1,"column":1553}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"initializeUnorderedBulkOp","original":{"line":129,"column":0},"generated":{"line":1,"column":1556}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"UnorderedBulkOperation","original":{"line":129,"column":26},"generated":{"line":1,"column":1558}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"UnorderedBulkOperation","original":{"line":129,"column":51},"generated":{"line":1,"column":1581}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"module","original":{"line":130,"column":0},"generated":{"line":1,"column":1583}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"exports","original":{"line":130,"column":7},"generated":{"line":1,"column":1590}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"initializeUnorderedBulkOp","original":{"line":130,"column":17},"generated":{"line":1,"column":1598}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"module","original":{"line":131,"column":0},"generated":{"line":1,"column":1600}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"exports","original":{"line":131,"column":7},"generated":{"line":1,"column":1607}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"Bulk","original":{"line":131,"column":15},"generated":{"line":1,"column":1615}},{"source":"../node_modules/mongodb/lib/bulk/unordered.js","name":"UnorderedBulkOperation","original":{"line":131,"column":22},"generated":{"line":1,"column":1620}}],"sources":{"../node_modules/mongodb/lib/bulk/unordered.js":"'use strict';\n\nconst common = require('./common');\nconst BulkOperationBase = common.BulkOperationBase;\nconst Batch = common.Batch;\nconst bson = common.bson;\nconst utils = require('../utils');\nconst toError = utils.toError;\n\n/**\n * Add to internal list of Operations\n *\n * @ignore\n * @param {UnorderedBulkOperation} bulkOperation\n * @param {number} docType number indicating the document type\n * @param {object} document\n * @return {UnorderedBulkOperation}\n */\nfunction addToOperationsList(bulkOperation, docType, document) {\n  // Get the bsonSize\n  const bsonSize = bson.calculateObjectSize(document, {\n    checkKeys: false,\n\n    // Since we don't know what the user selected for BSON options here,\n    // err on the safe side, and check the size with ignoreUndefined: false.\n    ignoreUndefined: false\n  });\n  // Throw error if the doc is bigger than the max BSON size\n  if (bsonSize >= bulkOperation.s.maxBsonObjectSize)\n    throw toError('document is larger than the maximum size ' + bulkOperation.s.maxBsonObjectSize);\n  // Holds the current batch\n  bulkOperation.s.currentBatch = null;\n  // Get the right type of batch\n  if (docType === common.INSERT) {\n    bulkOperation.s.currentBatch = bulkOperation.s.currentInsertBatch;\n  } else if (docType === common.UPDATE) {\n    bulkOperation.s.currentBatch = bulkOperation.s.currentUpdateBatch;\n  } else if (docType === common.REMOVE) {\n    bulkOperation.s.currentBatch = bulkOperation.s.currentRemoveBatch;\n  }\n\n  const maxKeySize = bulkOperation.s.maxKeySize;\n\n  // Create a new batch object if we don't have a current one\n  if (bulkOperation.s.currentBatch == null)\n    bulkOperation.s.currentBatch = new Batch(docType, bulkOperation.s.currentIndex);\n\n  // Check if we need to create a new batch\n  if (\n    // New batch if we exceed the max batch op size\n    bulkOperation.s.currentBatch.size + 1 >= bulkOperation.s.maxWriteBatchSize ||\n    // New batch if we exceed the maxBatchSizeBytes. Only matters if batch already has a doc,\n    // since we can't sent an empty batch\n    (bulkOperation.s.currentBatch.size > 0 &&\n      bulkOperation.s.currentBatch.sizeBytes + maxKeySize + bsonSize >=\n        bulkOperation.s.maxBatchSizeBytes) ||\n    // New batch if the new op does not have the same op type as the current batch\n    bulkOperation.s.currentBatch.batchType !== docType\n  ) {\n    // Save the batch to the execution stack\n    bulkOperation.s.batches.push(bulkOperation.s.currentBatch);\n\n    // Create a new batch\n    bulkOperation.s.currentBatch = new Batch(docType, bulkOperation.s.currentIndex);\n  }\n\n  // We have an array of documents\n  if (Array.isArray(document)) {\n    throw toError('operation passed in cannot be an Array');\n  }\n\n  bulkOperation.s.currentBatch.operations.push(document);\n  bulkOperation.s.currentBatch.originalIndexes.push(bulkOperation.s.currentIndex);\n  bulkOperation.s.currentIndex = bulkOperation.s.currentIndex + 1;\n\n  // Save back the current Batch to the right type\n  if (docType === common.INSERT) {\n    bulkOperation.s.currentInsertBatch = bulkOperation.s.currentBatch;\n    bulkOperation.s.bulkResult.insertedIds.push({\n      index: bulkOperation.s.bulkResult.insertedIds.length,\n      _id: document._id\n    });\n  } else if (docType === common.UPDATE) {\n    bulkOperation.s.currentUpdateBatch = bulkOperation.s.currentBatch;\n  } else if (docType === common.REMOVE) {\n    bulkOperation.s.currentRemoveBatch = bulkOperation.s.currentBatch;\n  }\n\n  // Update current batch size\n  bulkOperation.s.currentBatch.size += 1;\n  bulkOperation.s.currentBatch.sizeBytes += maxKeySize + bsonSize;\n\n  // Return bulkOperation\n  return bulkOperation;\n}\n\n/**\n * Create a new UnorderedBulkOperation instance (INTERNAL TYPE, do not instantiate directly)\n * @class\n * @extends BulkOperationBase\n * @property {number} length Get the number of operations in the bulk.\n * @return {UnorderedBulkOperation} a UnorderedBulkOperation instance.\n */\nclass UnorderedBulkOperation extends BulkOperationBase {\n  constructor(topology, collection, options) {\n    options = options || {};\n    options = Object.assign(options, { addToOperationsList });\n\n    super(topology, collection, options, false);\n  }\n\n  handleWriteError(callback, writeResult) {\n    if (this.s.batches.length) {\n      return false;\n    }\n\n    return super.handleWriteError(callback, writeResult);\n  }\n}\n\n/**\n * Returns an unordered batch object\n * @ignore\n */\nfunction initializeUnorderedBulkOp(topology, collection, options) {\n  return new UnorderedBulkOperation(topology, collection, options);\n}\n\ninitializeUnorderedBulkOp.UnorderedBulkOperation = UnorderedBulkOperation;\nmodule.exports = initializeUnorderedBulkOp;\nmodule.exports.Bulk = UnorderedBulkOperation;\n"},"lineCount":null}},"error":null,"hash":"242ff3634294e12b42aaadd78603acb4","cacheData":{"env":{}}}