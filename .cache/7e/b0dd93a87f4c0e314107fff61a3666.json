{"id":"Dkhp","dependencies":[{"name":"/Users/etienne/skyenv/package.json","includedInParent":true,"mtime":1596478551490},{"name":"/Users/etienne/skyenv/node_modules/mongodb/package.json","includedInParent":true,"mtime":1596467161400},{"name":"./operation","loc":{"line":4,"column":30},"parent":"/Users/etienne/skyenv/node_modules/mongodb/lib/operations/create_indexes.js","resolved":"/Users/etienne/skyenv/node_modules/mongodb/lib/operations/operation.js"},{"name":"./command_v2","loc":{"line":5,"column":35},"parent":"/Users/etienne/skyenv/node_modules/mongodb/lib/operations/create_indexes.js","resolved":"/Users/etienne/skyenv/node_modules/mongodb/lib/operations/command_v2.js"},{"name":"../core","loc":{"line":6,"column":27},"parent":"/Users/etienne/skyenv/node_modules/mongodb/lib/operations/create_indexes.js","resolved":"/Users/etienne/skyenv/node_modules/mongodb/lib/core/index.js"},{"name":"../utils","loc":{"line":7,"column":34},"parent":"/Users/etienne/skyenv/node_modules/mongodb/lib/operations/create_indexes.js","resolved":"/Users/etienne/skyenv/node_modules/mongodb/lib/utils.js"},{"name":"../core/utils","loc":{"line":8,"column":31},"parent":"/Users/etienne/skyenv/node_modules/mongodb/lib/operations/create_indexes.js","resolved":"/Users/etienne/skyenv/node_modules/mongodb/lib/core/utils.js"}],"generated":{"js":"\"use strict\";const e=require(\"./operation\").Aspect,o=require(\"./operation\").defineAspects,r=require(\"./command_v2\"),n=require(\"../core\").MongoError,t=require(\"../utils\").parseIndexOptions,i=require(\"../core/utils\").maxWireVersion,s=new Set([\"unique\",\"partialFilterExpression\",\"sparse\",\"background\",\"expireAfterSeconds\",\"storageEngine\",\"collation\",\"bucketSize\"]);class c extends r{constructor(e,o,r,n){if(super(e,n),this.collection=o,Array.isArray(r)&&!Array.isArray(r[0]))this.indexes=r;else{this.onlyReturnNameOfCreatedIndex=!0;const e=t(r),o={name:\"string\"==typeof n.name?n.name:e.name,key:e.fieldHash};for(let r in n)s.has(r)&&(o[r]=n[r]);this.indexes=[o]}}execute(e,o){const r=this.options,t=this.indexes,s=i(e);for(let i=0;i<t.length;i++){if(t[i].collation&&s<5)return void o(new n(\"Server \".concat(e.name,\", which reports wire version \").concat(s,\", does not support collation\")));if(null==t[i].name){const e=[];for(let o in t[i].key)e.push(\"\".concat(o,\"_\").concat(t[i].key[o]));t[i].name=e.join(\"_\")}}const c={createIndexes:this.collection,indexes:t};if(null!=r.commitQuorum){if(s<9)return void o(new n(\"`commitQuorum` option for `createIndexes` not supported on servers < 4.4\"));c.commitQuorum=r.commitQuorum}this.options.collation=void 0,super.executeCommand(e,c,(e,r)=>{e?o(e):o(null,this.onlyReturnNameOfCreatedIndex?t[0].name:r)})}}o(c,[e.WRITE_OPERATION,e.EXECUTE_WITH_SELECTION]),module.exports=c;"},"sourceMaps":{"js":{"mappings":[{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":1,"column":0},"generated":{"line":1,"column":0}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":3,"column":0},"generated":{"line":1,"column":13}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"Aspect","original":{"line":3,"column":6},"generated":{"line":1,"column":19}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"require","original":{"line":3,"column":15},"generated":{"line":1,"column":21}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":3,"column":23},"generated":{"line":1,"column":29}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"Aspect","original":{"line":3,"column":38},"generated":{"line":1,"column":44}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"defineAspects","original":{"line":4,"column":6},"generated":{"line":1,"column":51}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"require","original":{"line":4,"column":22},"generated":{"line":1,"column":53}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":4,"column":30},"generated":{"line":1,"column":61}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"defineAspects","original":{"line":4,"column":45},"generated":{"line":1,"column":76}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"CommandOperationV2","original":{"line":5,"column":6},"generated":{"line":1,"column":90}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"require","original":{"line":5,"column":27},"generated":{"line":1,"column":92}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":5,"column":35},"generated":{"line":1,"column":100}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"MongoError","original":{"line":6,"column":6},"generated":{"line":1,"column":116}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"require","original":{"line":6,"column":19},"generated":{"line":1,"column":118}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":6,"column":27},"generated":{"line":1,"column":126}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"MongoError","original":{"line":6,"column":38},"generated":{"line":1,"column":137}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"parseIndexOptions","original":{"line":7,"column":6},"generated":{"line":1,"column":148}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"require","original":{"line":7,"column":26},"generated":{"line":1,"column":150}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":7,"column":34},"generated":{"line":1,"column":158}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"parseIndexOptions","original":{"line":7,"column":46},"generated":{"line":1,"column":170}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"maxWireVersion","original":{"line":8,"column":6},"generated":{"line":1,"column":188}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"require","original":{"line":8,"column":23},"generated":{"line":1,"column":190}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":8,"column":31},"generated":{"line":1,"column":198}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"maxWireVersion","original":{"line":8,"column":48},"generated":{"line":1,"column":215}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"validIndexOptions","original":{"line":10,"column":6},"generated":{"line":1,"column":230}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":10,"column":26},"generated":{"line":1,"column":232}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"Set","original":{"line":10,"column":30},"generated":{"line":1,"column":236}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":10,"column":34},"generated":{"line":1,"column":240}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":11,"column":2},"generated":{"line":1,"column":241}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":12,"column":2},"generated":{"line":1,"column":250}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":13,"column":2},"generated":{"line":1,"column":276}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":14,"column":2},"generated":{"line":1,"column":285}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":15,"column":2},"generated":{"line":1,"column":298}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":16,"column":2},"generated":{"line":1,"column":319}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":17,"column":2},"generated":{"line":1,"column":335}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":18,"column":2},"generated":{"line":1,"column":347}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":21,"column":0},"generated":{"line":1,"column":362}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"CreateIndexesOperation","original":{"line":21,"column":6},"generated":{"line":1,"column":368}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"CommandOperationV2","original":{"line":21,"column":37},"generated":{"line":1,"column":378}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"constructor","original":{"line":25,"column":2},"generated":{"line":1,"column":380}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"parent","original":{"line":25,"column":14},"generated":{"line":1,"column":392}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"collection","original":{"line":25,"column":22},"generated":{"line":1,"column":394}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":25,"column":34},"generated":{"line":1,"column":396}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"options","original":{"line":25,"column":43},"generated":{"line":1,"column":398}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":34,"column":8},"generated":{"line":1,"column":401}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"parent","original":{"line":26,"column":10},"generated":{"line":1,"column":404}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"parent","original":{"line":26,"column":10},"generated":{"line":1,"column":410}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"options","original":{"line":26,"column":18},"generated":{"line":1,"column":412}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"collection","original":{"line":27,"column":9},"generated":{"line":1,"column":415}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"collection","original":{"line":27,"column":9},"generated":{"line":1,"column":420}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"collection","original":{"line":27,"column":22},"generated":{"line":1,"column":431}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"Array","original":{"line":34,"column":9},"generated":{"line":1,"column":433}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"isArray","original":{"line":34,"column":15},"generated":{"line":1,"column":439}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":34,"column":23},"generated":{"line":1,"column":447}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"Array","original":{"line":34,"column":35},"generated":{"line":1,"column":452}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"isArray","original":{"line":34,"column":41},"generated":{"line":1,"column":458}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":34,"column":49},"generated":{"line":1,"column":466}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":34,"column":57},"generated":{"line":1,"column":468}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":53,"column":9},"generated":{"line":1,"column":472}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":53,"column":9},"generated":{"line":1,"column":477}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":53,"column":19},"generated":{"line":1,"column":485}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":34,"column":8},"generated":{"line":1,"column":491}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"onlyReturnNameOfCreatedIndex","original":{"line":35,"column":11},"generated":{"line":1,"column":492}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"onlyReturnNameOfCreatedIndex","original":{"line":35,"column":11},"generated":{"line":1,"column":497}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":35,"column":42},"generated":{"line":1,"column":527}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexParameters","original":{"line":38,"column":12},"generated":{"line":1,"column":529}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexParameters","original":{"line":38,"column":12},"generated":{"line":1,"column":535}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"parseIndexOptions","original":{"line":38,"column":30},"generated":{"line":1,"column":537}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":38,"column":48},"generated":{"line":1,"column":539}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexSpec","original":{"line":42,"column":12},"generated":{"line":1,"column":542}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":42,"column":24},"generated":{"line":1,"column":544}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"name","original":{"line":42,"column":26},"generated":{"line":1,"column":545}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":40,"column":43},"generated":{"line":1,"column":550}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"options","original":{"line":40,"column":26},"generated":{"line":1,"column":567}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"name","original":{"line":40,"column":34},"generated":{"line":1,"column":569}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"options","original":{"line":40,"column":54},"generated":{"line":1,"column":574}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"name","original":{"line":40,"column":62},"generated":{"line":1,"column":576}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexParameters","original":{"line":40,"column":69},"generated":{"line":1,"column":581}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"name","original":{"line":40,"column":85},"generated":{"line":1,"column":583}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"key","original":{"line":42,"column":32},"generated":{"line":1,"column":588}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexParameters","original":{"line":42,"column":37},"generated":{"line":1,"column":592}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"fieldHash","original":{"line":42,"column":53},"generated":{"line":1,"column":594}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":44,"column":11},"generated":{"line":1,"column":605}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":44,"column":11},"generated":{"line":1,"column":609}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"optionName","original":{"line":44,"column":15},"generated":{"line":1,"column":613}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"options","original":{"line":44,"column":29},"generated":{"line":1,"column":618}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"validIndexOptions","original":{"line":45,"column":12},"generated":{"line":1,"column":620}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"has","original":{"line":45,"column":30},"generated":{"line":1,"column":622}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"optionName","original":{"line":45,"column":34},"generated":{"line":1,"column":626}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexSpec","original":{"line":46,"column":10},"generated":{"line":1,"column":631}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"optionName","original":{"line":46,"column":20},"generated":{"line":1,"column":633}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"options","original":{"line":46,"column":34},"generated":{"line":1,"column":636}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"optionName","original":{"line":46,"column":42},"generated":{"line":1,"column":638}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":49,"column":11},"generated":{"line":1,"column":642}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":49,"column":11},"generated":{"line":1,"column":647}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":49,"column":21},"generated":{"line":1,"column":655}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexSpec","original":{"line":49,"column":22},"generated":{"line":1,"column":656}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"execute","original":{"line":59,"column":2},"generated":{"line":1,"column":660}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"server","original":{"line":59,"column":10},"generated":{"line":1,"column":668}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"callback","original":{"line":59,"column":18},"generated":{"line":1,"column":670}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"options","original":{"line":60,"column":10},"generated":{"line":1,"column":673}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"options","original":{"line":60,"column":10},"generated":{"line":1,"column":679}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":60,"column":20},"generated":{"line":1,"column":681}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"options","original":{"line":60,"column":25},"generated":{"line":1,"column":686}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":61,"column":10},"generated":{"line":1,"column":694}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":61,"column":20},"generated":{"line":1,"column":696}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":61,"column":25},"generated":{"line":1,"column":701}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"serverWireVersion","original":{"line":63,"column":10},"generated":{"line":1,"column":709}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"maxWireVersion","original":{"line":63,"column":30},"generated":{"line":1,"column":711}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"server","original":{"line":63,"column":45},"generated":{"line":1,"column":713}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":66,"column":9},"generated":{"line":1,"column":716}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":66,"column":9},"generated":{"line":1,"column":720}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"i","original":{"line":66,"column":13},"generated":{"line":1,"column":724}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":66,"column":17},"generated":{"line":1,"column":726}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"i","original":{"line":66,"column":20},"generated":{"line":1,"column":728}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":66,"column":24},"generated":{"line":1,"column":730}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"length","original":{"line":66,"column":32},"generated":{"line":1,"column":732}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"i","original":{"line":66,"column":40},"generated":{"line":1,"column":739}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":66,"column":45},"generated":{"line":1,"column":743}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":68,"column":10},"generated":{"line":1,"column":744}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":68,"column":10},"generated":{"line":1,"column":747}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"i","original":{"line":68,"column":18},"generated":{"line":1,"column":749}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"collation","original":{"line":68,"column":21},"generated":{"line":1,"column":752}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"serverWireVersion","original":{"line":68,"column":34},"generated":{"line":1,"column":763}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":68,"column":54},"generated":{"line":1,"column":765}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":74,"column":8},"generated":{"line":1,"column":767}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"callback","original":{"line":69,"column":8},"generated":{"line":1,"column":779}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":70,"column":10},"generated":{"line":1,"column":781}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"MongoError","original":{"line":70,"column":14},"generated":{"line":1,"column":785}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"server","original":{"line":71,"column":22},"generated":{"line":1,"column":787}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"server","original":{"line":71,"column":22},"generated":{"line":1,"column":797}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"server","original":{"line":71,"column":22},"generated":{"line":1,"column":804}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"name","original":{"line":71,"column":29},"generated":{"line":1,"column":806}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"serverWireVersion","original":{"line":71,"column":65},"generated":{"line":1,"column":811}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"serverWireVersion","original":{"line":71,"column":65},"generated":{"line":1,"column":844}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"serverWireVersion","original":{"line":71,"column":65},"generated":{"line":1,"column":851}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":69,"column":16},"generated":{"line":1,"column":853}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":77,"column":10},"generated":{"line":1,"column":887}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":77,"column":29},"generated":{"line":1,"column":890}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":77,"column":10},"generated":{"line":1,"column":896}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"i","original":{"line":77,"column":18},"generated":{"line":1,"column":898}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"name","original":{"line":77,"column":21},"generated":{"line":1,"column":901}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":77,"column":35},"generated":{"line":1,"column":906}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"keys","original":{"line":78,"column":14},"generated":{"line":1,"column":907}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"keys","original":{"line":78,"column":14},"generated":{"line":1,"column":913}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":78,"column":21},"generated":{"line":1,"column":915}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":80,"column":13},"generated":{"line":1,"column":918}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":80,"column":13},"generated":{"line":1,"column":922}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"name","original":{"line":80,"column":17},"generated":{"line":1,"column":926}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":80,"column":25},"generated":{"line":1,"column":931}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"i","original":{"line":80,"column":33},"generated":{"line":1,"column":933}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"key","original":{"line":80,"column":36},"generated":{"line":1,"column":936}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"keys","original":{"line":81,"column":10},"generated":{"line":1,"column":940}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"push","original":{"line":81,"column":15},"generated":{"line":1,"column":942}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"name","original":{"line":81,"column":23},"generated":{"line":1,"column":947}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"name","original":{"line":81,"column":23},"generated":{"line":1,"column":950}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"name","original":{"line":81,"column":23},"generated":{"line":1,"column":957}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":81,"column":31},"generated":{"line":1,"column":959}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":81,"column":31},"generated":{"line":1,"column":964}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":81,"column":31},"generated":{"line":1,"column":971}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"i","original":{"line":81,"column":39},"generated":{"line":1,"column":973}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"key","original":{"line":81,"column":42},"generated":{"line":1,"column":976}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"name","original":{"line":81,"column":46},"generated":{"line":1,"column":980}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":85,"column":8},"generated":{"line":1,"column":985}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"i","original":{"line":85,"column":16},"generated":{"line":1,"column":987}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"name","original":{"line":85,"column":19},"generated":{"line":1,"column":990}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"keys","original":{"line":85,"column":26},"generated":{"line":1,"column":995}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"join","original":{"line":85,"column":31},"generated":{"line":1,"column":997}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":85,"column":36},"generated":{"line":1,"column":1002}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"cmd","original":{"line":89,"column":10},"generated":{"line":1,"column":1008}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"cmd","original":{"line":89,"column":10},"generated":{"line":1,"column":1014}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":89,"column":16},"generated":{"line":1,"column":1016}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"createIndexes","original":{"line":89,"column":18},"generated":{"line":1,"column":1017}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":89,"column":33},"generated":{"line":1,"column":1031}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"collection","original":{"line":89,"column":38},"generated":{"line":1,"column":1036}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":89,"column":50},"generated":{"line":1,"column":1047}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":89,"column":50},"generated":{"line":1,"column":1055}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"options","original":{"line":91,"column":8},"generated":{"line":1,"column":1058}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":91,"column":32},"generated":{"line":1,"column":1061}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"options","original":{"line":91,"column":8},"generated":{"line":1,"column":1067}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"commitQuorum","original":{"line":91,"column":16},"generated":{"line":1,"column":1069}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":91,"column":38},"generated":{"line":1,"column":1082}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"serverWireVersion","original":{"line":92,"column":10},"generated":{"line":1,"column":1083}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"serverWireVersion","original":{"line":92,"column":10},"generated":{"line":1,"column":1086}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":92,"column":30},"generated":{"line":1,"column":1088}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":96,"column":8},"generated":{"line":1,"column":1090}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"callback","original":{"line":93,"column":8},"generated":{"line":1,"column":1102}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":94,"column":10},"generated":{"line":1,"column":1104}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"MongoError","original":{"line":94,"column":14},"generated":{"line":1,"column":1108}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":94,"column":25},"generated":{"line":1,"column":1110}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"cmd","original":{"line":98,"column":6},"generated":{"line":1,"column":1187}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"commitQuorum","original":{"line":98,"column":10},"generated":{"line":1,"column":1189}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"options","original":{"line":98,"column":25},"generated":{"line":1,"column":1202}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"commitQuorum","original":{"line":98,"column":33},"generated":{"line":1,"column":1204}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"options","original":{"line":102,"column":9},"generated":{"line":1,"column":1217}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"options","original":{"line":102,"column":9},"generated":{"line":1,"column":1222}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"collation","original":{"line":102,"column":17},"generated":{"line":1,"column":1230}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"undefined","original":{"line":102,"column":29},"generated":{"line":1,"column":1245}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"executeCommand","original":{"line":104,"column":10},"generated":{"line":1,"column":1247}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"executeCommand","original":{"line":104,"column":10},"generated":{"line":1,"column":1253}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"server","original":{"line":104,"column":25},"generated":{"line":1,"column":1268}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"cmd","original":{"line":104,"column":33},"generated":{"line":1,"column":1270}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":104,"column":38},"generated":{"line":1,"column":1272}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"err","original":{"line":104,"column":39},"generated":{"line":1,"column":1273}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"result","original":{"line":104,"column":44},"generated":{"line":1,"column":1275}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"err","original":{"line":105,"column":10},"generated":{"line":1,"column":1280}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"callback","original":{"line":106,"column":8},"generated":{"line":1,"column":1282}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"err","original":{"line":106,"column":17},"generated":{"line":1,"column":1284}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"callback","original":{"line":110,"column":6},"generated":{"line":1,"column":1287}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":110,"column":15},"generated":{"line":1,"column":1289}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":110,"column":21},"generated":{"line":1,"column":1294}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"onlyReturnNameOfCreatedIndex","original":{"line":110,"column":26},"generated":{"line":1,"column":1299}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"indexes","original":{"line":110,"column":57},"generated":{"line":1,"column":1328}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":110,"column":65},"generated":{"line":1,"column":1330}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"name","original":{"line":110,"column":68},"generated":{"line":1,"column":1333}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"result","original":{"line":110,"column":75},"generated":{"line":1,"column":1338}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"defineAspects","original":{"line":115,"column":0},"generated":{"line":1,"column":1344}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"CreateIndexesOperation","original":{"line":115,"column":14},"generated":{"line":1,"column":1346}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","original":{"line":115,"column":38},"generated":{"line":1,"column":1348}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"Aspect","original":{"line":115,"column":39},"generated":{"line":1,"column":1349}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"WRITE_OPERATION","original":{"line":115,"column":46},"generated":{"line":1,"column":1351}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"Aspect","original":{"line":115,"column":63},"generated":{"line":1,"column":1367}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"EXECUTE_WITH_SELECTION","original":{"line":115,"column":70},"generated":{"line":1,"column":1369}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"module","original":{"line":117,"column":0},"generated":{"line":1,"column":1394}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"exports","original":{"line":117,"column":7},"generated":{"line":1,"column":1401}},{"source":"../node_modules/mongodb/lib/operations/create_indexes.js","name":"CreateIndexesOperation","original":{"line":117,"column":17},"generated":{"line":1,"column":1409}}],"sources":{"../node_modules/mongodb/lib/operations/create_indexes.js":"'use strict';\n\nconst Aspect = require('./operation').Aspect;\nconst defineAspects = require('./operation').defineAspects;\nconst CommandOperationV2 = require('./command_v2');\nconst MongoError = require('../core').MongoError;\nconst parseIndexOptions = require('../utils').parseIndexOptions;\nconst maxWireVersion = require('../core/utils').maxWireVersion;\n\nconst validIndexOptions = new Set([\n  'unique',\n  'partialFilterExpression',\n  'sparse',\n  'background',\n  'expireAfterSeconds',\n  'storageEngine',\n  'collation',\n  'bucketSize'\n]);\n\nclass CreateIndexesOperation extends CommandOperationV2 {\n  /**\n   * @ignore\n   */\n  constructor(parent, collection, indexes, options) {\n    super(parent, options);\n    this.collection = collection;\n\n    // createIndex can be called with a variety of styles:\n    //   coll.createIndex('a');\n    //   coll.createIndex({ a: 1 });\n    //   coll.createIndex([['a', 1]]);\n    // createIndexes is always called with an array of index spec objects\n    if (!Array.isArray(indexes) || Array.isArray(indexes[0])) {\n      this.onlyReturnNameOfCreatedIndex = true;\n      // TODO: remove in v4 (breaking change); make createIndex return full response as createIndexes does\n\n      const indexParameters = parseIndexOptions(indexes);\n      // Generate the index name\n      const name = typeof options.name === 'string' ? options.name : indexParameters.name;\n      // Set up the index\n      const indexSpec = { name, key: indexParameters.fieldHash };\n      // merge valid index options into the index spec\n      for (let optionName in options) {\n        if (validIndexOptions.has(optionName)) {\n          indexSpec[optionName] = options[optionName];\n        }\n      }\n      this.indexes = [indexSpec];\n      return;\n    }\n\n    this.indexes = indexes;\n  }\n\n  /**\n   * @ignore\n   */\n  execute(server, callback) {\n    const options = this.options;\n    const indexes = this.indexes;\n\n    const serverWireVersion = maxWireVersion(server);\n\n    // Ensure we generate the correct name if the parameter is not set\n    for (let i = 0; i < indexes.length; i++) {\n      // Did the user pass in a collation, check if our write server supports it\n      if (indexes[i].collation && serverWireVersion < 5) {\n        callback(\n          new MongoError(\n            `Server ${server.name}, which reports wire version ${serverWireVersion}, does not support collation`\n          )\n        );\n        return;\n      }\n\n      if (indexes[i].name == null) {\n        const keys = [];\n\n        for (let name in indexes[i].key) {\n          keys.push(`${name}_${indexes[i].key[name]}`);\n        }\n\n        // Set the name\n        indexes[i].name = keys.join('_');\n      }\n    }\n\n    const cmd = { createIndexes: this.collection, indexes };\n\n    if (options.commitQuorum != null) {\n      if (serverWireVersion < 9) {\n        callback(\n          new MongoError('`commitQuorum` option for `createIndexes` not supported on servers < 4.4')\n        );\n        return;\n      }\n      cmd.commitQuorum = options.commitQuorum;\n    }\n\n    // collation is set on each index, it should not be defined at the root\n    this.options.collation = undefined;\n\n    super.executeCommand(server, cmd, (err, result) => {\n      if (err) {\n        callback(err);\n        return;\n      }\n\n      callback(null, this.onlyReturnNameOfCreatedIndex ? indexes[0].name : result);\n    });\n  }\n}\n\ndefineAspects(CreateIndexesOperation, [Aspect.WRITE_OPERATION, Aspect.EXECUTE_WITH_SELECTION]);\n\nmodule.exports = CreateIndexesOperation;\n"},"lineCount":null}},"error":null,"hash":"78c9dac59c93bd9968d7cb493162ec69","cacheData":{"env":{}}}