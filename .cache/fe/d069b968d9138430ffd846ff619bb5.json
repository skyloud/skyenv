{"id":"hFp3","dependencies":[{"name":"/Users/etienne/skyenv/package.json","includedInParent":true,"mtime":1596478551490},{"name":"/Users/etienne/skyenv/node_modules/mongodb/package.json","includedInParent":true,"mtime":1596467161400},{"name":"./operation","loc":{"line":3,"column":30},"parent":"/Users/etienne/skyenv/node_modules/mongodb/lib/operations/insert_many.js","resolved":"/Users/etienne/skyenv/node_modules/mongodb/lib/operations/operation.js"},{"name":"./bulk_write","loc":{"line":4,"column":35},"parent":"/Users/etienne/skyenv/node_modules/mongodb/lib/operations/insert_many.js","resolved":"/Users/etienne/skyenv/node_modules/mongodb/lib/operations/bulk_write.js"},{"name":"../core","loc":{"line":5,"column":27},"parent":"/Users/etienne/skyenv/node_modules/mongodb/lib/operations/insert_many.js","resolved":"/Users/etienne/skyenv/node_modules/mongodb/lib/core/index.js"},{"name":"./common_functions","loc":{"line":6,"column":28},"parent":"/Users/etienne/skyenv/node_modules/mongodb/lib/operations/insert_many.js","resolved":"/Users/etienne/skyenv/node_modules/mongodb/lib/operations/common_functions.js"}],"generated":{"js":"\"use strict\";const e=require(\"./operation\").OperationBase,t=require(\"./bulk_write\"),r=require(\"../core\").MongoError,s=require(\"./common_functions\").prepareDocs;class n extends e{constructor(e,t,r){super(r),this.collection=e,this.docs=t}execute(e){const n=this.collection;let i=this.docs;const u=this.options;if(!Array.isArray(i))return e(r.create({message:\"docs parameter must be an array of documents\",driver:!0}));u.serializeFunctions=u.serializeFunctions||n.s.serializeFunctions,i=s(n,i,u),new t(n,[{insertMany:i}],u).execute((t,r)=>{if(t)return e(t,null);e(null,o(i,r))})}}function o(e,t){const r={result:{ok:1,n:t.insertedCount},ops:e,insertedCount:t.insertedCount,insertedIds:t.insertedIds};return t.getLastOp()&&(r.result.opTime=t.getLastOp()),r}module.exports=n;"},"sourceMaps":{"js":{"mappings":[{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":1,"column":0},"generated":{"line":1,"column":0}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":3,"column":0},"generated":{"line":1,"column":13}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"OperationBase","original":{"line":3,"column":6},"generated":{"line":1,"column":19}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"require","original":{"line":3,"column":22},"generated":{"line":1,"column":21}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":3,"column":30},"generated":{"line":1,"column":29}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"OperationBase","original":{"line":3,"column":45},"generated":{"line":1,"column":44}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"BulkWriteOperation","original":{"line":4,"column":6},"generated":{"line":1,"column":58}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"require","original":{"line":4,"column":27},"generated":{"line":1,"column":60}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":4,"column":35},"generated":{"line":1,"column":68}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"MongoError","original":{"line":5,"column":6},"generated":{"line":1,"column":84}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"require","original":{"line":5,"column":19},"generated":{"line":1,"column":86}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":5,"column":27},"generated":{"line":1,"column":94}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"MongoError","original":{"line":5,"column":38},"generated":{"line":1,"column":105}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"prepareDocs","original":{"line":6,"column":6},"generated":{"line":1,"column":116}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"require","original":{"line":6,"column":20},"generated":{"line":1,"column":118}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":6,"column":28},"generated":{"line":1,"column":126}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"prepareDocs","original":{"line":6,"column":50},"generated":{"line":1,"column":148}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":8,"column":0},"generated":{"line":1,"column":160}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"InsertManyOperation","original":{"line":8,"column":6},"generated":{"line":1,"column":166}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"OperationBase","original":{"line":8,"column":34},"generated":{"line":1,"column":176}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"constructor","original":{"line":9,"column":2},"generated":{"line":1,"column":178}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"collection","original":{"line":9,"column":14},"generated":{"line":1,"column":190}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"docs","original":{"line":9,"column":26},"generated":{"line":1,"column":192}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"options","original":{"line":9,"column":32},"generated":{"line":1,"column":194}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"options","original":{"line":10,"column":10},"generated":{"line":1,"column":197}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"options","original":{"line":10,"column":10},"generated":{"line":1,"column":203}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"collection","original":{"line":12,"column":9},"generated":{"line":1,"column":206}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"collection","original":{"line":12,"column":9},"generated":{"line":1,"column":211}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"collection","original":{"line":12,"column":22},"generated":{"line":1,"column":222}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"docs","original":{"line":13,"column":9},"generated":{"line":1,"column":224}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"docs","original":{"line":13,"column":9},"generated":{"line":1,"column":229}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"docs","original":{"line":13,"column":16},"generated":{"line":1,"column":234}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"execute","original":{"line":16,"column":2},"generated":{"line":1,"column":236}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"callback","original":{"line":16,"column":10},"generated":{"line":1,"column":244}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"coll","original":{"line":17,"column":10},"generated":{"line":1,"column":247}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"coll","original":{"line":17,"column":10},"generated":{"line":1,"column":253}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":17,"column":17},"generated":{"line":1,"column":255}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"collection","original":{"line":17,"column":22},"generated":{"line":1,"column":260}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"docs","original":{"line":18,"column":8},"generated":{"line":1,"column":271}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"docs","original":{"line":18,"column":8},"generated":{"line":1,"column":275}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":18,"column":15},"generated":{"line":1,"column":277}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"docs","original":{"line":18,"column":20},"generated":{"line":1,"column":282}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"options","original":{"line":19,"column":10},"generated":{"line":1,"column":287}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"options","original":{"line":19,"column":10},"generated":{"line":1,"column":293}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":19,"column":20},"generated":{"line":1,"column":295}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"options","original":{"line":19,"column":25},"generated":{"line":1,"column":300}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":21,"column":8},"generated":{"line":1,"column":308}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"Array","original":{"line":21,"column":9},"generated":{"line":1,"column":312}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"isArray","original":{"line":21,"column":15},"generated":{"line":1,"column":318}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"docs","original":{"line":21,"column":23},"generated":{"line":1,"column":326}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"callback","original":{"line":22,"column":13},"generated":{"line":1,"column":329}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"callback","original":{"line":22,"column":13},"generated":{"line":1,"column":336}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"MongoError","original":{"line":23,"column":8},"generated":{"line":1,"column":338}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"create","original":{"line":23,"column":19},"generated":{"line":1,"column":340}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":23,"column":26},"generated":{"line":1,"column":347}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"message","original":{"line":23,"column":28},"generated":{"line":1,"column":348}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":23,"column":37},"generated":{"line":1,"column":356}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"driver","original":{"line":23,"column":85},"generated":{"line":1,"column":403}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":23,"column":93},"generated":{"line":1,"column":411}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"options","original":{"line":28,"column":4},"generated":{"line":1,"column":416}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":28,"column":11},"generated":{"line":1,"column":418}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"options","original":{"line":28,"column":36},"generated":{"line":1,"column":437}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":28,"column":43},"generated":{"line":1,"column":439}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"coll","original":{"line":28,"column":69},"generated":{"line":1,"column":459}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"s","original":{"line":28,"column":74},"generated":{"line":1,"column":461}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"serializeFunctions","original":{"line":28,"column":76},"generated":{"line":1,"column":463}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"docs","original":{"line":30,"column":4},"generated":{"line":1,"column":482}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"prepareDocs","original":{"line":30,"column":11},"generated":{"line":1,"column":484}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"coll","original":{"line":30,"column":23},"generated":{"line":1,"column":486}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"docs","original":{"line":30,"column":29},"generated":{"line":1,"column":488}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"options","original":{"line":30,"column":35},"generated":{"line":1,"column":490}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":39,"column":31},"generated":{"line":1,"column":493}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"BulkWriteOperation","original":{"line":39,"column":35},"generated":{"line":1,"column":497}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"coll","original":{"line":39,"column":54},"generated":{"line":1,"column":499}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":33,"column":23},"generated":{"line":1,"column":501}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":34,"column":6},"generated":{"line":1,"column":502}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"insertMany","original":{"line":35,"column":8},"generated":{"line":1,"column":503}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"docs","original":{"line":35,"column":20},"generated":{"line":1,"column":514}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"options","original":{"line":39,"column":72},"generated":{"line":1,"column":518}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"execute","original":{"line":41,"column":23},"generated":{"line":1,"column":521}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":41,"column":31},"generated":{"line":1,"column":529}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"err","original":{"line":41,"column":32},"generated":{"line":1,"column":530}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"result","original":{"line":41,"column":37},"generated":{"line":1,"column":532}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"err","original":{"line":42,"column":10},"generated":{"line":1,"column":537}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"err","original":{"line":42,"column":10},"generated":{"line":1,"column":540}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":42,"column":15},"generated":{"line":1,"column":542}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"callback","original":{"line":42,"column":22},"generated":{"line":1,"column":549}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"err","original":{"line":42,"column":31},"generated":{"line":1,"column":551}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":42,"column":36},"generated":{"line":1,"column":553}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"callback","original":{"line":43,"column":6},"generated":{"line":1,"column":559}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":43,"column":15},"generated":{"line":1,"column":561}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"mapInsertManyResults","original":{"line":43,"column":21},"generated":{"line":1,"column":566}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"docs","original":{"line":43,"column":42},"generated":{"line":1,"column":568}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"result","original":{"line":43,"column":48},"generated":{"line":1,"column":570}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":48,"column":0},"generated":{"line":1,"column":577}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"mapInsertManyResults","original":{"line":48,"column":9},"generated":{"line":1,"column":586}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"docs","original":{"line":48,"column":30},"generated":{"line":1,"column":588}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"r","original":{"line":48,"column":36},"generated":{"line":1,"column":590}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"finalResult","original":{"line":49,"column":8},"generated":{"line":1,"column":593}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"finalResult","original":{"line":49,"column":8},"generated":{"line":1,"column":599}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":49,"column":22},"generated":{"line":1,"column":601}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"result","original":{"line":50,"column":4},"generated":{"line":1,"column":602}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":50,"column":12},"generated":{"line":1,"column":609}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"ok","original":{"line":50,"column":14},"generated":{"line":1,"column":610}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","original":{"line":50,"column":18},"generated":{"line":1,"column":613}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"n","original":{"line":50,"column":21},"generated":{"line":1,"column":615}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"r","original":{"line":50,"column":24},"generated":{"line":1,"column":617}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"insertedCount","original":{"line":50,"column":26},"generated":{"line":1,"column":619}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"ops","original":{"line":51,"column":4},"generated":{"line":1,"column":634}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"docs","original":{"line":51,"column":9},"generated":{"line":1,"column":638}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"insertedCount","original":{"line":52,"column":4},"generated":{"line":1,"column":640}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"r","original":{"line":52,"column":19},"generated":{"line":1,"column":654}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"insertedCount","original":{"line":52,"column":21},"generated":{"line":1,"column":656}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"insertedIds","original":{"line":53,"column":4},"generated":{"line":1,"column":670}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"r","original":{"line":53,"column":17},"generated":{"line":1,"column":682}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"insertedIds","original":{"line":53,"column":19},"generated":{"line":1,"column":684}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"finalResult","original":{"line":60,"column":9},"generated":{"line":1,"column":697}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"r","original":{"line":56,"column":6},"generated":{"line":1,"column":704}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"getLastOp","original":{"line":56,"column":8},"generated":{"line":1,"column":706}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"finalResult","original":{"line":57,"column":4},"generated":{"line":1,"column":720}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"result","original":{"line":57,"column":16},"generated":{"line":1,"column":722}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"opTime","original":{"line":57,"column":23},"generated":{"line":1,"column":729}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"r","original":{"line":57,"column":32},"generated":{"line":1,"column":736}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"getLastOp","original":{"line":57,"column":34},"generated":{"line":1,"column":738}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"finalResult","original":{"line":60,"column":9},"generated":{"line":1,"column":751}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"module","original":{"line":63,"column":0},"generated":{"line":1,"column":753}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"exports","original":{"line":63,"column":7},"generated":{"line":1,"column":760}},{"source":"../node_modules/mongodb/lib/operations/insert_many.js","name":"InsertManyOperation","original":{"line":63,"column":17},"generated":{"line":1,"column":768}}],"sources":{"../node_modules/mongodb/lib/operations/insert_many.js":"'use strict';\n\nconst OperationBase = require('./operation').OperationBase;\nconst BulkWriteOperation = require('./bulk_write');\nconst MongoError = require('../core').MongoError;\nconst prepareDocs = require('./common_functions').prepareDocs;\n\nclass InsertManyOperation extends OperationBase {\n  constructor(collection, docs, options) {\n    super(options);\n\n    this.collection = collection;\n    this.docs = docs;\n  }\n\n  execute(callback) {\n    const coll = this.collection;\n    let docs = this.docs;\n    const options = this.options;\n\n    if (!Array.isArray(docs)) {\n      return callback(\n        MongoError.create({ message: 'docs parameter must be an array of documents', driver: true })\n      );\n    }\n\n    // If keep going set unordered\n    options['serializeFunctions'] = options['serializeFunctions'] || coll.s.serializeFunctions;\n\n    docs = prepareDocs(coll, docs, options);\n\n    // Generate the bulk write operations\n    const operations = [\n      {\n        insertMany: docs\n      }\n    ];\n\n    const bulkWriteOperation = new BulkWriteOperation(coll, operations, options);\n\n    bulkWriteOperation.execute((err, result) => {\n      if (err) return callback(err, null);\n      callback(null, mapInsertManyResults(docs, result));\n    });\n  }\n}\n\nfunction mapInsertManyResults(docs, r) {\n  const finalResult = {\n    result: { ok: 1, n: r.insertedCount },\n    ops: docs,\n    insertedCount: r.insertedCount,\n    insertedIds: r.insertedIds\n  };\n\n  if (r.getLastOp()) {\n    finalResult.result.opTime = r.getLastOp();\n  }\n\n  return finalResult;\n}\n\nmodule.exports = InsertManyOperation;\n"},"lineCount":null}},"error":null,"hash":"5b1605ecc08ae048b1341ca8f83ac73f","cacheData":{"env":{}}}